name: "plan"
description: "Create tasks.md from design.md. Break down feature into actionable, dependency-ordered tasks."
steps:
  - name: "Detect active scope and feature directory"
    command: |
      # Check if user specified feature name in arguments
      # If not, look for most recent .oursky/scopes/*/design.md
      # If multiple exist, ask user which feature
      # Extract feature name from directory: .oursky/scopes/{date-prefix}-{FeatureName}/
      # Pattern: YYYYMMDD-HHMMSS-FeatureName
      # Extract FeatureName by removing date prefix
      # Set FEATURE_NAME = FeatureName (PascalCase)
      # Set FEATURE_DIR = .oursky/scopes/{date-prefix}-{FeatureName}/
      # Report active scope: "Working on feature: [FeatureName]"
  - name: "Load design.md"
    command: |
      # Read FEATURE_DIR/design.md
      # Extract: requirements, success criteria, user scenarios, technical considerations
      # If missing: ERROR "design.md not found. Run /design first."
  - name: "Load memory documentation"
    command: |
      # Read .oursky/memory/constitution.md (mandatory)
      # Check relevant memory files for patterns
      # Prefer memory over codebase for patterns
  - name: "Generate tasks.md"
    command: |
      # Location: FEATURE_DIR/tasks.md
      # Structure with status legend, notes, phases
      # Organize by phase: Setup → Core → Integration → Testing → Polish
      # Mark dependencies and parallel work
      # Follow TDD: test tasks before implementation
  - name: "Validate completeness"
    command: |
      # Each requirement from design.md has corresponding tasks
      # Success criteria can be verified through tasks
      # Dependencies are clear
      # Test tasks included
  - name: "Present to user"
    command: |
      # Show tasks.md structure
      # Ask: "Does this task breakdown look complete? Any changes needed?"
      # Handle feedback: update design.md and tasks.md with clarifications
      # Iterate until approved
  - name: "After approval"
    command: |
      # End with: "Tasks ready! Type 'GO!' or use /implement when ready to start implementation"
      # Wait for explicit approval before implementing